name: Security Scan

on:
    pull_request:
        branches: [main, preprocessing]
    push:
        branches: [main, preprocessing]
    schedule:
        # Run weekly on Mondays at 9am UTC
        - cron: "0 9 * * 1"

jobs:
    pip-audit:
        name: Scan Python Dependencies
        runs-on: ubuntu-latest

        steps:
            - uses: actions/checkout@v4

            - name: Install uv
              uses: astral-sh/setup-uv@v3
              with:
                  enable-cache: true

            - name: Set up Python
              run: uv python install 3.11

            - name: Install dependencies
              run: uv sync --group dev

            - name: Scan dependencies with pip-audit
              run: uv run pip-audit
              continue-on-error: true
